import copy

cards = [{
    "A": 11,
    "2": 2,
    "3": 3,
    "4": 4,
    "5": 5,
    "6": 6,
    "7": 7,
    "8": 8,
    "9": 9,
    "10": 10,
    "J": 10,
    "Q": 10,
    "K": 10
    }]


#temp until it works
deck = [copy.deepcopy(cards[0]) for _ in range(4)]  # 4 independent dictionaries

# Create the deck as a list
question_deck = int(input("Number of decks being played: "))
deck_played = [copy.deepcopy(card) for _ in range(question_deck) for card in deck]
 

print (deck_played)


#list is important to account for double dealing of Aces
player_hand = []


#this works now. I do not know why but it works. DON'T TOUCH!!!
def get_valid_card(prompt):
    while True:
        player_card = input(prompt).upper()
        for card_dict in deck_played:
            if player_card in card_dict:
                # Retrieve the value and remove the card only from the current dictionary
                value = card_dict.pop(player_card)
                return value  # Exit immediately after processing the first match
        print("Invalid card. Please try again.")

# Get first card
player_card1 = get_valid_card("What is your first card? ")
player_hand.append(player_card1)

# Get second card
player_card2 = get_valid_card("What is your second card? ")
player_hand.append(player_card2)
    
# Get third card
player_card3 = get_valid_card("What is your third card? ")
player_hand.append(player_card3)

# Get fourth card
player_card4 = get_valid_card("What is your fourth card? ")
player_hand.append(player_card4)

# Get fifth card
player_card5 = get_valid_card("What is your fifth card? ")
player_hand.append(player_card5)



#to account double Aces dealing on first hand
if len(player_hand) == 2 and sum(player_hand) == 22:
    player_hand [0] = 10

print (f"Player hand is {player_hand}")
print (f"Total sum of cards is: {sum(player_hand)}")


"""Calculation of percentage on next card to not burst

Formula: i = (21 - player_hand)/ number of card left in deck_played

This script works to run through entire card left in deck"""

points_left = 21-sum(player_hand)

# Initialize counter
count_perc = 0
number_card_left = 0
# Loop through each dictionary in the list
for deck_dict in deck_played:
    # Loop through inner the dictionary in the list
    for card_name, card_value in deck_dict.items():
        if card_value <= points_left:
            count_perc += 1

print(f"Number of cards below {points_left} points: {count_perc} cards")


for no_card in deck_played:
    card_in_dict = len(no_card)
    number_card_left += card_in_dict

#calculate percentage that next card wouldn't burst
percentage_v2 = count_perc/number_card_left*100
print(f"{percentage_v2:.2f}%")
